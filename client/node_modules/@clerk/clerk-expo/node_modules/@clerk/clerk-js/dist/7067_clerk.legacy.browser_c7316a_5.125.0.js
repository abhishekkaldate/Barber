"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["7067"],{8181:function(a,t,o){o.d(t,{D:()=>s});var e=o(73312),i=o(6654),n=o(25623),r=o(64204),l=o(17703);let s=a=>{let{organization:t,showLoadingSpinner:o,...s}=a;return(0,e.BX)(r.Col,{elementDescriptor:r.descriptors.organizationAvatarUploaderContainer,children:[(0,e.tZ)(r.Text,{variant:"subtitle",sx:a=>({textAlign:"left",marginBottom:a.space.$2}),localizationKey:(0,l.u1)("organizationProfile.start.profileSection.uploadAction__title")}),(0,e.tZ)(i.C,{...s,title:(0,l.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,e.tZ)(n.l,{size:a=>a.sizes.$16,showLoadingSpinner:o,...t})})]})}},57484:function(a,t,o){o.d(t,{AO:()=>e,Sz:()=>i});let e={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},i=(a,t,o)=>{var e;if(void 0===t)return[{data:[a],total_count:1}];let i=(null==t||null==(e=t[t.length-1])?void 0:e.total_count)||1;return t.map(t=>{if(void 0===t)return t;let e=t.data.map(t=>t.id===a.id?{...a}:t);return{...t,data:e,total_count:"negative"===o?i-1:i}})}},7008:function(a,t,o){o.r(t),o.d(t,{TaskChooseOrganization:()=>X}),o(65223);var e=o(73312),i=o(61869),n=o(69144),r=o(11576),l=o(64204),s=o(92418),c=o(2672),d=o(92654),u=o(54264),g=o(76028),h=o(31753),z=o(41024),p=o(20237),v=o(57484),C=o(86988),m=o(42305),O=o(35973),Z=o(96519),y=o(88870);let b=a=>{var t,o,n;let r=(0,c.useCardState)(),{user:u}=(0,i.aF)(),{ref:h,userMemberships:z,userSuggestions:v,userInvitations:C}=(0,g.H)(),O=(null==z?void 0:z.isLoading)||(null==C?void 0:C.isLoading)||(null==v?void 0:v.isLoading),Z=(null==z?void 0:z.hasNextPage)||(null==C?void 0:C.hasNextPage)||(null==v?void 0:v.hasNextPage),y=null==(t=C.data)?void 0:t.filter(a=>!!a),b=null==(o=v.data)?void 0:o.filter(a=>!!a);return(0,e.BX)(e.HY,{children:[(0,e.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$8)}),children:[(0,e.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.title")}),(0,e.tZ)(d.h.Subtitle,{localizationKey:(null==u?void 0:u.createOrganizationEnabled)?(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle"):(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle__createOrganizationDisabled")})]}),(0,e.tZ)(s.Z.Alert,{sx:a=>({margin:"".concat(a.space.$none," ").concat(a.space.$8)}),children:r.error}),(0,e.tZ)(l.Col,{elementDescriptor:l.descriptors.main,children:(0,e.tZ)(p.o2,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItems,children:(0,e.BX)(m.eX,{role:"menu",children:[(z.count||0)>0&&(null==(n=z.data)?void 0:n.map(a=>(0,e.tZ)(k,{...a},a.id))),!z.hasNextPage&&(null==y?void 0:y.map(a=>(0,e.tZ)(_,{...a},a.id))),!z.hasNextPage&&!C.hasNextPage&&(null==b?void 0:b.map(a=>(0,e.tZ)(f,{...a},a.id))),(Z||O)&&(0,e.tZ)(p.pr,{ref:h}),(0,e.tZ)(w,{onCreateOrganizationClick:()=>{r.setError(void 0),a.onCreateOrganizationClick()}})]})})})]})},k=a=>{let{user:t}=(0,i.aF)(),o=(0,c.useCardState)(),{navigateOnSetActive:n}=(0,C.G)(),{redirectUrlComplete:r}=(0,C._)(),{isLoaded:s,setActive:d}=(0,i.eW)(),{t:u}=(0,l.useLocalizations)();return s?(0,e.tZ)(p.Td,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewButton,onClick:()=>{let e;return e=a.organization,o.runAsync(async()=>{try{await d({organization:e,navigate:async a=>{let{session:t}=a;await (null==n?void 0:n({session:t,redirectUrlComplete:r}))}})}catch(e){var a,i;if(!(0,z.kD)(e))return void(0,y.S3)(e,[],o.setError);switch(null==(i=e.errors)||null==(a=i[0])?void 0:a.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":(null==t?void 0:t.createOrganizationEnabled)?o.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):o.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,y.S3)(e,[],o.setError)}}})},children:(0,e.tZ)(O.Z,{elementId:"taskChooseOrganization",mainIdentifierSx:p.fq,organization:a.organization})}):null},_=a=>{let t=(0,c.useCardState)(),{getOrganization:o}=(0,i.cL)(),[r,s]=(0,n.useState)(null),{userInvitations:d}=(0,i.eW)({userInvitations:v.AO.userInvitations});return r?(0,e.tZ)(k,{organization:r}):(0,e.tZ)(p.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:(0,e.tZ)(p.De,{isLoading:t.isLoading,onClick:()=>t.runAsync(async()=>[await a.accept(),await o(a.publicOrganizationData.id)]).then(a=>{var t;let[o,e]=a;null==d||null==(t=d.setData)||t.call(d,a=>(0,v.Sz)(o,a,"negative")),s(e)}).catch(a=>(0,y.S3)(a,[],t.setError)),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__invitationAccept")})})},f=(0,c.withCardStateProvider)(a=>{let t=(0,c.useCardState)(),{userSuggestions:o}=(0,i.eW)({userSuggestions:v.AO.userSuggestions});return(0,e.tZ)(p.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:"accepted"===a.status?(0,e.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.suggestionsAcceptedLabel")}):(0,e.tZ)(p.De,{onClick:()=>t.runAsync(a.accept).then(a=>{var t;return null==o||null==(t=o.setData)?void 0:t.call(o,t=>(0,v.Sz)(a,t))}).catch(a=>(0,y.S3)(a,[],t.setError)),isLoading:t.isLoading,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__suggestionsAccept")})})}),w=a=>{let{onCreateOrganizationClick:t}=a,{user:o}=(0,i.aF)();return(null==o?void 0:o.createOrganizationEnabled)?(0,e.tZ)(m.aU,{elementDescriptor:l.descriptors.taskChooseOrganizationCreateOrganizationActionButton,icon:Z.mm,label:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__createOrganization"),onClick:t,sx:a=>({borderTopWidth:a.borderWidths.$normal,borderTopStyle:a.borderStyles.$solid,borderTopColor:a.colors.$borderAlpha100,padding:"".concat(a.space.$5," ").concat(a.space.$5)}),iconSx:a=>({width:a.sizes.$9,height:a.sizes.$6})}):null};o(50725),o(70332);var S=o(8181),D=o(70431),K=o(19460),x=o(68487),$=o(53412),P=o(7259),A=o(36788),L=o(30215);function F(a){let{organizationCreationDefaults:t}=a,o=I(null==t?void 0:t.advisory);return o?(0,e.tZ)(L.bZ,{colorScheme:"warning",children:(0,e.tZ)(l.Text,{colorScheme:"warning",localizationKey:o,variant:"caption"})}):null}let I=a=>a&&"organization_already_exists"===a.code?(0,l.localizationKeys)("taskChooseOrganization.alerts.organizationAlreadyExists",{organizationDomain:a.meta.organization_domain,organizationName:a.meta.organization_name}):null,B=a=>{var t,o,s,u,g,h,z,p;let m=(0,c.useCardState)(),{navigateOnSetActive:O}=(0,C.G)(),{redirectUrlComplete:b}=(0,C._)(),{createOrganization:k,isLoaded:_,setActive:f}=(0,i.eW)({userMemberships:v.AO.userMemberships}),{organizationSettings:w}=(0,r.useEnvironment)(),[L,I]=(0,n.useState)(),B=(0,A.Yp)("name",null!=(z=null==(o=a.organizationCreationDefaults)||null==(t=o.form)?void 0:t.name)?z:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__name"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__name")}),R=(0,A.Yp)("slug",null!=(p=null==(u=a.organizationCreationDefaults)||null==(s=u.form)?void 0:s.slug)?p:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__slug"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__slug")}),T=!w.slug.disabled,E=async a=>{if(a.preventDefault(),_)try{let a={name:B.value};T&&(a.slug=R.value);let t=await k(a),o=X(t);await Promise.allSettled([o]),await f({organization:t,navigate:async a=>{let{session:t}=a;await (null==O?void 0:O({session:t,redirectUrlComplete:b}))}})}catch(a){(0,y.S3)(a,[B,R],m.setError)}},X=async a=>{if(L)await a.setLogo({file:L});else if(N){let t=await fetch(N),o=await t.blob(),e=new File([o],"logo",{type:o.type});await a.setLogo({file:e})}},W=a=>{R.setValue(a)},j=!B.value||!_,N=void 0===L?null==(h=a.organizationCreationDefaults)||null==(g=h.form)?void 0:g.logo:void 0;return(0,e.BX)(e.HY,{children:[(0,e.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$8)}),children:[(0,e.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.title")}),(0,e.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.subtitle")})]}),(0,e.tZ)(x.Y,{sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$10," ").concat(a.space.$8)}),children:(0,e.BX)(D.l.Root,{onSubmit:E,children:[(0,e.tZ)(F,{organizationCreationDefaults:a.organizationCreationDefaults}),(0,e.tZ)(S.D,{organization:{name:B.value,imageUrl:null!=N?N:void 0},onAvatarChange:async a=>await I(a),onAvatarRemove:L||N?()=>(m.setIdle(),I(null)):null,showLoadingSpinner:!!N,avatarPreviewPlaceholder:(0,e.tZ)($.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,e.tZ)(l.Icon,{size:"md",icon:Z.gq,sx:a=>({color:a.colors.$colorMutedForeground,transitionDuration:a.transitionDuration.$controls})}),sx:a=>({width:a.sizes.$16,height:a.sizes.$16,borderRadius:a.radii.$md,borderWidth:a.borderWidths.$normal,borderStyle:a.borderStyles.$dashed,borderColor:a.colors.$borderAlpha200,backgroundColor:a.colors.$neutralAlpha50,":hover":{backgroundColor:a.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})}),(0,e.tZ)(D.l.ControlRow,{elementId:B.id,children:(0,e.tZ)(D.l.PlainInput,{...B.props,onChange:a=>{B.setValue(a.target.value),W((0,P.q)(a.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),T&&(0,e.tZ)(D.l.ControlRow,{elementId:R.id,children:(0,e.tZ)(D.l.PlainInput,{...R.props,onChange:a=>W(a.target.value),isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,e.BX)(K.K,{sx:()=>({flexDirection:"column"}),children:[(0,e.tZ)(D.l.SubmitButton,{block:!0,isDisabled:j,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonSubmit")}),a.onCancel&&(0,e.tZ)(D.l.ResetButton,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonReset"),onClick:a.onCancel})]})]})})]})},R=()=>{var a,t;let{signOut:o}=(0,i.cL)(),{user:n}=(0,i.aF)(),{session:c}=(0,i.kP)(),{otherSessions:d}=(0,u.j)({user:n}),{navigateAfterSignOut:g,navigateAfterMultiSessionSingleSignOutUrl:h}=(0,r.useSignOutContext)(),z=null!=(t=null==n||null==(a=n.primaryEmailAddress)?void 0:a.emailAddress)?t:null==n?void 0:n.username;return(0,e.tZ)(s.Z.Footer,{children:(0,e.BX)(s.Z.Action,{elementId:"signOut",gap:2,justify:"center",sx:()=>({width:"100%"}),children:[z&&(0,e.tZ)(s.Z.ActionText,{truncate:!0,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionText",{identifier:z})}),(0,e.tZ)(s.Z.ActionLink,{sx:()=>({flexShrink:0}),onClick:()=>0===d.length?o(g):o(h,{sessionId:null==c?void 0:c.id}),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionLink")})]})})},T=(0,c.withCardStateProvider)(a=>{let[t,o]=(0,n.useState)(a.initialFlow);return"create"===t?(0,e.tZ)(B,{onCancel:"choose"===a.initialFlow?()=>o("choose"):void 0,organizationCreationDefaults:a.organizationCreationDefaults}):(0,e.tZ)(b,{onCreateOrganizationClick:()=>o("create")})});function E(){return(0,e.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,e.tZ)(l.Flow.Part,{part:"organizationCreationDisabled",children:(0,e.BX)(s.Z.Root,{children:[(0,e.tZ)(s.Z.Content,{children:(0,e.BX)(d.h.Root,{showLogo:!0,children:[(0,e.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.title")}),(0,e.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.subtitle")})]})}),(0,e.tZ)(R,{})]})})})}let X=(0,r.withCoreSessionSwitchGuard)((0,h.U)((0,c.withCardStateProvider)(()=>{let{user:a}=(0,i.aF)(),{userMemberships:t,userSuggestions:o,userInvitations:n}=(0,g.H)(),r=(0,i.vm)(),c=(null==t?void 0:t.isLoading)||(null==n?void 0:n.isLoading)||(null==o?void 0:o.isLoading)||(null==r?void 0:r.isLoading),d=!!((null==t?void 0:t.count)||(null==n?void 0:n.count)||(null==o?void 0:o.count));return c||(null==a?void 0:a.createOrganizationEnabled)||d?(0,e.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,e.tZ)(l.Flow.Part,{part:"chooseOrganization",children:(0,e.BX)(s.Z.Root,{children:[(0,e.tZ)(s.Z.Content,{sx:a=>({padding:"".concat(a.space.$8," ").concat(a.space.$none," ").concat(a.space.$none),gap:a.space.$7}),children:c?(0,e.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:a=>({height:"100%",minHeight:a.sizes.$100}),children:(0,e.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(0,e.tZ)(T,{initialFlow:d?"choose":"create",organizationCreationDefaults:r.data})}),(0,e.tZ)(R,{})]})})}):(0,e.tZ)(E,{})}),"choose-organization"))}}]);