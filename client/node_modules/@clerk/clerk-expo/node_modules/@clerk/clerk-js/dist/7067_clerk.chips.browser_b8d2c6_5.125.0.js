"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["7067"],{8181:function(a,t,e){e.d(t,{D:()=>l});var o=e(73312),i=e(6654),n=e(25623),r=e(64204),s=e(17703);let l=a=>{let{organization:t,showLoadingSpinner:e,...l}=a;return(0,o.BX)(r.Col,{elementDescriptor:r.descriptors.organizationAvatarUploaderContainer,children:[(0,o.tZ)(r.Text,{variant:"subtitle",sx:a=>({textAlign:"left",marginBottom:a.space.$2}),localizationKey:(0,s.u1)("organizationProfile.start.profileSection.uploadAction__title")}),(0,o.tZ)(i.C,{...l,title:(0,s.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(n.l,{size:a=>a.sizes.$16,showLoadingSpinner:e,...t})})]})}},57484:function(a,t,e){e.d(t,{AO:()=>o,Sz:()=>i});let o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},i=(a,t,e)=>{if(void 0===t)return[{data:[a],total_count:1}];let o=t?.[t.length-1]?.total_count||1;return t.map(t=>{if(void 0===t)return t;let i=t.data.map(t=>t.id===a.id?{...a}:t);return{...t,data:i,total_count:"negative"===e?o-1:o}})}},7008:function(a,t,e){e.r(t),e.d(t,{TaskChooseOrganization:()=>X});var o=e(73312),i=e(61869),n=e(69144),r=e(11576),s=e(64204),l=e(92418),c=e(2672),d=e(92654),g=e(54264),u=e(76028),h=e(31753),z=e(41024),p=e(20237),C=e(57484),m=e(86988),O=e(42305),Z=e(35973),y=e(34174),b=e(88870);let k=a=>{let t=(0,c.useCardState)(),{user:e}=(0,i.aF)(),{ref:n,userMemberships:r,userSuggestions:g,userInvitations:h}=(0,u.H)(),z=r?.isLoading||h?.isLoading||g?.isLoading,C=r?.hasNextPage||h?.hasNextPage||g?.hasNextPage,m=h.data?.filter(a=>!!a),Z=g.data?.filter(a=>!!a);return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:`${a.space.$none} ${a.space.$8}`}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:e?.createOrganizationEnabled?(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle"):(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle__createOrganizationDisabled")})]}),(0,o.tZ)(l.Z.Alert,{sx:a=>({margin:`${a.space.$none} ${a.space.$8}`}),children:t.error}),(0,o.tZ)(s.Col,{elementDescriptor:s.descriptors.main,children:(0,o.tZ)(p.o2,{elementDescriptor:s.descriptors.taskChooseOrganizationPreviewItems,children:(0,o.BX)(O.eX,{role:"menu",children:[(r.count||0)>0&&r.data?.map(a=>(0,o.tZ)(_,{...a},a.id)),!r.hasNextPage&&m?.map(a=>(0,o.tZ)(f,{...a},a.id)),!r.hasNextPage&&!h.hasNextPage&&Z?.map(a=>(0,o.tZ)(w,{...a},a.id)),(C||z)&&(0,o.tZ)(p.pr,{ref:n}),(0,o.tZ)(v,{onCreateOrganizationClick:()=>{t.setError(void 0),a.onCreateOrganizationClick()}})]})})})]})},_=a=>{let{user:t}=(0,i.aF)(),e=(0,c.useCardState)(),{navigateOnSetActive:n}=(0,m.G)(),{redirectUrlComplete:r}=(0,m._)(),{isLoaded:l,setActive:d}=(0,i.eW)(),{t:g}=(0,s.useLocalizations)();return l?(0,o.tZ)(p.Td,{elementDescriptor:s.descriptors.taskChooseOrganizationPreviewButton,onClick:()=>{let o;return o=a.organization,e.runAsync(async()=>{try{await d({organization:o,navigate:async({session:a})=>{await n?.({session:a,redirectUrlComplete:r})}})}catch(a){if(!(0,z.kD)(a))return void(0,b.S3)(a,[],e.setError);switch(a.errors?.[0]?.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":t?.createOrganizationEnabled?e.setError(g((0,s.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):e.setError(g((0,s.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,b.S3)(a,[],e.setError)}}})},children:(0,o.tZ)(Z.Z,{elementId:"taskChooseOrganization",mainIdentifierSx:p.fq,organization:a.organization})}):null},f=a=>{let t=(0,c.useCardState)(),{getOrganization:e}=(0,i.cL)(),[r,l]=(0,n.useState)(null),{userInvitations:d}=(0,i.eW)({userInvitations:C.AO.userInvitations});return r?(0,o.tZ)(_,{organization:r}):(0,o.tZ)(p.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:s.descriptors.taskChooseOrganizationPreviewItem,children:(0,o.tZ)(p.De,{isLoading:t.isLoading,onClick:()=>t.runAsync(async()=>[await a.accept(),await e(a.publicOrganizationData.id)]).then(([a,t])=>{d?.setData?.(t=>(0,C.Sz)(a,t,"negative")),l(t)}).catch(a=>(0,b.S3)(a,[],t.setError)),localizationKey:(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.action__invitationAccept")})})},w=(0,c.withCardStateProvider)(a=>{let t=(0,c.useCardState)(),{userSuggestions:e}=(0,i.eW)({userSuggestions:C.AO.userSuggestions});return(0,o.tZ)(p.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:s.descriptors.taskChooseOrganizationPreviewItem,children:"accepted"===a.status?(0,o.tZ)(s.Text,{colorScheme:"secondary",localizationKey:(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.suggestionsAcceptedLabel")}):(0,o.tZ)(p.De,{onClick:()=>t.runAsync(a.accept).then(a=>e?.setData?.(t=>(0,C.Sz)(a,t))).catch(a=>(0,b.S3)(a,[],t.setError)),isLoading:t.isLoading,localizationKey:(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.action__suggestionsAccept")})})}),v=({onCreateOrganizationClick:a})=>{let{user:t}=(0,i.aF)();return t?.createOrganizationEnabled?(0,o.tZ)(O.aU,{elementDescriptor:s.descriptors.taskChooseOrganizationCreateOrganizationActionButton,icon:y.mm,label:(0,s.localizationKeys)("taskChooseOrganization.chooseOrganization.action__createOrganization"),onClick:a,sx:a=>({borderTopWidth:a.borderWidths.$normal,borderTopStyle:a.borderStyles.$solid,borderTopColor:a.colors.$borderAlpha100,padding:`${a.space.$5} ${a.space.$5}`}),iconSx:a=>({width:a.sizes.$9,height:a.sizes.$6})}):null};var $=e(8181),S=e(70431),D=e(19460),K=e(68487),x=e(53412),P=e(7259),A=e(36788),L=e(30215);function F({organizationCreationDefaults:a}){let t=I(a?.advisory);return t?(0,o.tZ)(L.bZ,{colorScheme:"warning",children:(0,o.tZ)(s.Text,{colorScheme:"warning",localizationKey:t,variant:"caption"})}):null}let I=a=>a&&"organization_already_exists"===a.code?(0,s.localizationKeys)("taskChooseOrganization.alerts.organizationAlreadyExists",{organizationDomain:a.meta.organization_domain,organizationName:a.meta.organization_name}):null,B=a=>{let t=(0,c.useCardState)(),{navigateOnSetActive:e}=(0,m.G)(),{redirectUrlComplete:l}=(0,m._)(),{createOrganization:g,isLoaded:u,setActive:h}=(0,i.eW)({userMemberships:C.AO.userMemberships}),{organizationSettings:z}=(0,r.useEnvironment)(),[p,O]=(0,n.useState)(),Z=(0,A.Yp)("name",a.organizationCreationDefaults?.form?.name??"",{type:"text",label:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__name"),placeholder:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__name")}),k=(0,A.Yp)("slug",a.organizationCreationDefaults?.form?.slug??"",{type:"text",label:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__slug"),placeholder:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__slug")}),_=!z.slug.disabled,f=async a=>{if(a.preventDefault(),u)try{let a={name:Z.value};_&&(a.slug=k.value);let t=await g(a),o=w(t);await Promise.allSettled([o]),await h({organization:t,navigate:async({session:a})=>{await e?.({session:a,redirectUrlComplete:l})}})}catch(a){(0,b.S3)(a,[Z,k],t.setError)}},w=async a=>{if(p)await a.setLogo({file:p});else if(I){let t=await fetch(I),e=await t.blob(),o=new File([e],"logo",{type:e.type});await a.setLogo({file:o})}},v=a=>{k.setValue(a)},L=!Z.value||!u,I=void 0===p?a.organizationCreationDefaults?.form?.logo:void 0;return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:`${a.space.$none} ${a.space.$8}`}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.subtitle")})]}),(0,o.tZ)(K.Y,{sx:a=>({padding:`${a.space.$none} ${a.space.$10} ${a.space.$8}`}),children:(0,o.BX)(S.l.Root,{onSubmit:f,children:[(0,o.tZ)(F,{organizationCreationDefaults:a.organizationCreationDefaults}),(0,o.tZ)($.D,{organization:{name:Z.value,imageUrl:I??void 0},onAvatarChange:async a=>await O(a),onAvatarRemove:p||I?()=>(t.setIdle(),O(null)):null,showLoadingSpinner:!!I,avatarPreviewPlaceholder:(0,o.tZ)(x.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,o.tZ)(s.Icon,{size:"md",icon:y.gq,sx:a=>({color:a.colors.$colorMutedForeground,transitionDuration:a.transitionDuration.$controls})}),sx:a=>({width:a.sizes.$16,height:a.sizes.$16,borderRadius:a.radii.$md,borderWidth:a.borderWidths.$normal,borderStyle:a.borderStyles.$dashed,borderColor:a.colors.$borderAlpha200,backgroundColor:a.colors.$neutralAlpha50,":hover":{backgroundColor:a.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})}),(0,o.tZ)(S.l.ControlRow,{elementId:Z.id,children:(0,o.tZ)(S.l.PlainInput,{...Z.props,onChange:a=>{Z.setValue(a.target.value),v((0,P.q)(a.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),_&&(0,o.tZ)(S.l.ControlRow,{elementId:k.id,children:(0,o.tZ)(S.l.PlainInput,{...k.props,onChange:a=>v(a.target.value),isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,o.BX)(D.K,{sx:()=>({flexDirection:"column"}),children:[(0,o.tZ)(S.l.SubmitButton,{block:!0,isDisabled:L,localizationKey:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formButtonSubmit")}),a.onCancel&&(0,o.tZ)(S.l.ResetButton,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.createOrganization.formButtonReset"),onClick:a.onCancel})]})]})})]})},R=()=>{let{signOut:a}=(0,i.cL)(),{user:t}=(0,i.aF)(),{session:e}=(0,i.kP)(),{otherSessions:n}=(0,g.j)({user:t}),{navigateAfterSignOut:c,navigateAfterMultiSessionSingleSignOutUrl:d}=(0,r.useSignOutContext)(),u=t?.primaryEmailAddress?.emailAddress??t?.username;return(0,o.tZ)(l.Z.Footer,{children:(0,o.BX)(l.Z.Action,{elementId:"signOut",gap:2,justify:"center",sx:()=>({width:"100%"}),children:[u&&(0,o.tZ)(l.Z.ActionText,{truncate:!0,localizationKey:(0,s.localizationKeys)("taskChooseOrganization.signOut.actionText",{identifier:u})}),(0,o.tZ)(l.Z.ActionLink,{sx:()=>({flexShrink:0}),onClick:()=>0===n.length?a(c):a(d,{sessionId:e?.id}),localizationKey:(0,s.localizationKeys)("taskChooseOrganization.signOut.actionLink")})]})})},T=(0,c.withCardStateProvider)(a=>{let[t,e]=(0,n.useState)(a.initialFlow);return"create"===t?(0,o.tZ)(B,{onCancel:"choose"===a.initialFlow?()=>e("choose"):void 0,organizationCreationDefaults:a.organizationCreationDefaults}):(0,o.tZ)(k,{onCreateOrganizationClick:()=>e("create")})});function E(){return(0,o.tZ)(s.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(s.Flow.Part,{part:"organizationCreationDisabled",children:(0,o.BX)(l.Z.Root,{children:[(0,o.tZ)(l.Z.Content,{children:(0,o.BX)(d.h.Root,{showLogo:!0,children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,s.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.subtitle")})]})}),(0,o.tZ)(R,{})]})})})}let X=(0,r.withCoreSessionSwitchGuard)((0,h.U)((0,c.withCardStateProvider)(()=>{let{user:a}=(0,i.aF)(),{userMemberships:t,userSuggestions:e,userInvitations:n}=(0,u.H)(),r=(0,i.vm)(),c=t?.isLoading||n?.isLoading||e?.isLoading||r?.isLoading,d=!!(t?.count||n?.count||e?.count);return c||a?.createOrganizationEnabled||d?(0,o.tZ)(s.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(s.Flow.Part,{part:"chooseOrganization",children:(0,o.BX)(l.Z.Root,{children:[(0,o.tZ)(l.Z.Content,{sx:a=>({padding:`${a.space.$8} ${a.space.$none} ${a.space.$none}`,gap:a.space.$7}),children:c?(0,o.tZ)(s.Flex,{direction:"row",align:"center",justify:"center",sx:a=>({height:"100%",minHeight:a.sizes.$100}),children:(0,o.tZ)(s.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:s.descriptors.spinner})}):(0,o.tZ)(T,{initialFlow:d?"choose":"create",organizationCreationDefaults:r.data})}),(0,o.tZ)(R,{})]})})}):(0,o.tZ)(E,{})}),"choose-organization"))}}]);